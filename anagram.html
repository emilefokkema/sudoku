<html>
<body>
	<div id="result"></div>
</body>
<script src="structureHelpers.js"></script>
<script>
(function(){
	var result = document.getElementById("result");
	var word = (function(){
		var string = window.location.hash ? window.location.hash.substr(1) : "abcd";
		var parts = string.match(/\w|\(\w+\)/g);
		return {
			permute:function(permutation){
				return permutation.map(function(i){return parts[i-1];}).join("")
			},
			length:parts.length
		};
	})();
	var filler = (function(){
		
		var permutaties = structureHelpers.permutatielijst(word.length);
		return {
			isDone:permutaties.isKlaar,
			fill:function(){
				var next = permutaties.volgende();
				if(next){
					var a = document.createElement("a");
					a.appendChild(document.createTextNode(word.permute(next)));

					result.appendChild(a);
					result.appendChild(document.createElement("br"));
				}
			}
		};
	})();
	var getCurrentResultBottom = function(){
		return result.getBoundingClientRect().bottom;
	};
	var fillScreen = (function(getBottom, filler){
		return function(){
			while(!filler.isDone() && getBottom() < window.scrollY + window.innerHeight + 500){
				filler.fill();
			}
		};
	})(getCurrentResultBottom, filler);
	setInterval(fillScreen, 200);
})();
</script>
</html>