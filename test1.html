<html>
	<head>
		<style>
			.message{
				border-radius:5px;
				margin:3px;
				padding:3px;
				font-family:Verdana;
			}
			.error-message{
				color:#a00;
				background-color:#fcc;
				border:1pt solid #a00;
			}
				.success-message{
				color:#0a0;
				background-color:#cfc;
				border:1pt solid #0a0;
			}
		</style>
	</head>
<body></body>
<script src="structureHelpers.js"></script>
<script src="makeModule.js"></script>
<script src="makeNode.js"></script>
<script src="contourMakerTest.js"></script>
<script src="contourMaker.js"></script>
<script src="contourViewer.js"></script>
<script>
;(function(){
	window.contourViewer = window.getContourViewer(makeNode, contourMaker.side, structureHelpers.copySet).append();
	var test = (function(){
		return function(name,t){
			try{
				t.apply({
					assert:function(bool, message){
						if(!bool && console.error){
							console.error("["+name+"] "+message);
						}
					},
					expect:function(actual){
						return {
							toBe:function(expected, message){
								if(actual != expected && console.error){
									console.error("["+name+"] "+(message||"")+" (expected "+expected+" but saw "+actual+")");
								}
							}
						};
					}
				},[]);
			}
			catch(e){
				console.error("["+name+"] "+e.message);
			}
			
		};
	})();

	test("makeModuleTest1",function(){
		var animal = makeModule(function(color){
			var name = 'animal';
			var makeName = function(){
				return 'a '+color+' '+name;
			};
			var move = function(){return 'ok';};
			this.expose({
				name:makeName(),
				move:move
			});

			this.extend('mammal',function(feet){
				name = 'mammal';
				makeName = this.override(makeName, function(){
					return this()+ ' with '+feet+' feet';
				});
				this.expose({
					name:makeName()
				});

				this.extend('lion',function(){
					name = 'lion';
					this.expose({
						name: makeName()
					});
				});
			});
		});

		var a1 = animal('green');
		var a2 = animal.mammal('green', 4);
		var a3 = animal.mammal.lion('green', 4);

		this.expect(a1.name).toBe('a green animal');
		this.expect(a2.name).toBe('a green mammal with 4 feet');
		this.expect(a3.name).toBe('a green lion with 4 feet');
		this.expect(a3.move()).toBe('ok');
	});

	window.contourMakerTest();
})()
</script>
</html>